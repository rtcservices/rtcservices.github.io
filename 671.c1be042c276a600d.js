"use strict";(self.webpackChunkcc_app=self.webpackChunkcc_app||[]).push([[671],{2671:(M,c,i)=>{i.r(c),i.d(c,{AuthModule:()=>V});var m=i(2011),d=i(4375);class h{constructor(s="",t="",r="",n="",a=""){this.email=s,this.userName=t,this.lastName=r,this.newPassword=n,this.confirmPassword=a}}var b=i(7579),p=i(2722),e=i(5e3),C=i(3071),x=i(8138),l=i(3075),_=i(9808);const w=["userDetailsForm"];function U(o,s){1&o&&(e.TgZ(0,"span",16),e._uU(1," User Name is required. "),e.qZA())}function P(o,s){if(1&o&&(e.TgZ(0,"div"),e.YNc(1,U,2,0,"span",12),e.qZA()),2&o){e.oxw();const t=e.MAs(12);e.xp6(1),e.Q6J("ngIf",t.errors.required)}}function N(o,s){1&o&&(e.TgZ(0,"span",17),e._uU(1,"You will receive an email shortly. If not, please check your spam folder."),e.qZA())}function A(o,s){1&o&&(e.TgZ(0,"span",16),e._uU(1,"Invalid User Name"),e.qZA())}let L=(()=>{class o{constructor(t,r,n){this.userService=t,this.router=r,this.notifierService=n,this.pageTitle="Forgot Password",this.ngUnsubscribe=new b.x,this.userName="",this.linkSuccess=!1,this.isSubmit=!1,this.userRegister=new h,this.saveButtonText="Submit",this.emailErrorMsg="",this.newPasswordErrMsg="",this.schoolId=0,this.isValidForm=!0}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}ngOnInit(){window.setTimeout(()=>{$("#txtUserName").val(""),$("#txtLastName").val(""),$("#txtEmail").val(""),$("#txtNewPassword").val("")},1e3)}generateResetLink(){this.userService.setResetPasswordLink(this.userRegister.userName).pipe((0,p.R)(this.ngUnsubscribe)).subscribe(t=>{this.isSubmit=!0,t?(this.linkSuccess=!0,this.isSubmit=!0,this.userDetailsForm.resetForm()):this.linkSuccess=!1},t=>{this.isSubmit=!0,this.linkSuccess=!1,this.saveButtonText="Submit"},()=>{this.isSubmit=!0,this.saveButtonText="Submit"})}generateRestPwdLink(){""!==this.userRegister.userName?(this.saveButtonText="Submitting...",this.generateResetLink()):this.notifierService.showNotification("warning","warning","You must provide a valid username.")}closeUser(){this.router.navigate(["/admin/manage-users",this.schoolId])}validateNewPasswordRequirments(){this.userService.checkPasswordComplexity(this.userRegister.newPassword).pipe((0,p.R)(this.ngUnsubscribe)).subscribe({next:r=>{"pass"!==r?(this.newPasswordErrMsg=r,this.isValidForm=!1):(this.isValidForm=!0,this.newPasswordErrMsg="")},error:r=>{this.isValidForm=!1}})}navLogin(){this.router.navigate(["auth/login"])}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(C.K),e.Y36(d.F0),e.Y36(x.l))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-forgot-password"]],viewQuery:function(t,r){if(1&t&&e.Gf(w,5),2&t){let n;e.iGM(n=e.CRH())&&(r.userDetailsForm=n.first)}},decls:20,vars:6,consts:[[1,"page-container"],[1,"fp-container"],[1,"fp-header"],["name","userform","id","userDetailsForm","autocomplete","off",3,"ngSubmit"],["userDetailsForm","ngForm"],[1,"form-group","row"],["for","txtUserName",1,"col"],[1,"col"],["id","txtUserName","name","txtUserName","type","text","required","",1,"form-control",3,"ngModel","ngModelChange"],["userName","ngModel"],[4,"ngIf"],["class","text-success",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"text-right"],["type","submit","name","userButton",1,"btn","btn-primary",3,"disabled"],["aria-hidden","true",1,"fa","fa-save"],[1,"text-danger"],[1,"text-success"]],template:function(t,r){if(1&t){const n=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5"),e._uU(4,"Forgot Password"),e.qZA()(),e.TgZ(5,"form",3,4),e.NdJ("ngSubmit",function(){return e.CHM(n),e.MAs(6).form.valid&&r.generateRestPwdLink()}),e.TgZ(7,"div",5)(8,"label",6),e._uU(9,"User Name"),e.qZA(),e.TgZ(10,"div",7)(11,"input",8,9),e.NdJ("ngModelChange",function(u){return r.userRegister.userName=u}),e.qZA(),e.YNc(13,P,2,1,"div",10),e.YNc(14,N,2,0,"span",11),e.YNc(15,A,2,0,"span",12),e.qZA()(),e.TgZ(16,"div",13)(17,"button",14),e._UZ(18,"i",15),e._uU(19),e.qZA()()()()()}if(2&t){const n=e.MAs(6),a=e.MAs(12);e.xp6(11),e.Q6J("ngModel",r.userRegister.userName),e.xp6(2),e.Q6J("ngIf",n.submitted&&a.invalid),e.xp6(1),e.Q6J("ngIf",r.linkSuccess&&r.isSubmit),e.xp6(1),e.Q6J("ngIf",!r.linkSuccess&&r.isSubmit),e.xp6(2),e.Q6J("disabled",""===r.userRegister.userName),e.xp6(2),e.hij(" ",r.saveButtonText,"")}},directives:[l._Y,l.JL,l.F,l.Fj,l.Q7,l.JJ,l.On,_.O5],styles:[".login-button[_ngcontent-%COMP%]{background-color:#62decd;border-radius:27px;color:#fff;height:35px;margin-right:5px}div.page-container[_ngcontent-%COMP%]{align-items:center;display:flex;font-size:1.5rem;height:calc(100vh - 350px);justify-content:center}div.fp-container[_ngcontent-%COMP%]{border:1px solid #9b9b9b;border-radius:5px;box-shadow:5px 5px 10px #9b9b9b;box-sizing:border-box;margin:0 auto;max-width:600px;text-align:center}div.fp-container[_ngcontent-%COMP%] > .fp-header[_ngcontent-%COMP%]{padding:.5rem 1.25rem;margin-bottom:0;background-color:#00000008;border-bottom:1px solid rgba(0,0,0,.125)}div.fp-container[_ngcontent-%COMP%] > form[_ngcontent-%COMP%]{padding:20px 10px 10px}div.fp-container[_ngcontent-%COMP%]   .login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-top:5px}.fp-button[_ngcontent-%COMP%]{background-color:#3e9dd3;border-top:0;border-right:0;border-left:0;border-bottom:2px solid #2473a0;box-shadow:0 2px #0000001a}.fp-button[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{background-color:#78bf57;border-bottom:2px solid #549238}"]}),o})();var g=i(2340),T=i(3266);class S{constructor(s="",t=""){this.UserName=s,this.Password=t}}i(7742);var y=i(8145),F=i(3980),Z=i(520);let O=(()=>{class o{constructor(){this.apiUrl=g.N.APIUrl+"Clever/"}get getUserDetailsFromCleverLoginEndpoint(){return this.apiUrl+"GetUserDetailsFromCleverLogin"}get setCleverCredentialsFromProfileEndpoint(){return this.apiUrl+"SetCleverCredentialsFromProfile"}get validateCleverUserAndTryLoginEndpoint(){return this.apiUrl+"ValidateCleverUserAndTryLogin"}get removeCleverLoginEndpoint(){return this.apiUrl+"RemoveCleverLogin/"}get addCleverLogEndpoint(){return this.apiUrl+"AddLog"}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),R=(()=>{class o{constructor(t,r,n){this.bypassedHttp=t,this.http=r,this.cleverConfig=n,this.clientId="da60e2e0d29b022a87e0",this.clientSecret="a53c4c053a9419c87a8cd3b76f664ba91385810d",this.districtId="5f885d50a4c60b0001f4ad4c",this.authorizeEndpoint="https://clever.com/oauth/authorize"}get redirectUrl(){return g.N.BaseUrl+"clever-oauth"}getLIWCUrl(t="login"){const r={response_type:"code",state:t,redirect_uri:this.redirectUrl,client_id:this.clientId};return this.authorizeEndpoint+"?"+Object.keys(r).map(a=>encodeURIComponent(a)+"="+encodeURIComponent(r[a])).join("&")}getUserDetailsFromCleverLogin(t){return this.bypassedHttp.post(this.cleverConfig.getUserDetailsFromCleverLoginEndpoint,{AccessCode:t,RedirectUrl:this.redirectUrl})}setCleverCredentialsFromProfile(t){return this.http.post(this.cleverConfig.setCleverCredentialsFromProfileEndpoint,{AccessCode:t,RedirectUrl:this.redirectUrl})}validateCleverUserAndTryLogin(t){return this.http.post(this.cleverConfig.validateCleverUserAndTryLoginEndpoint,{AccessCode:t,RedirectUrl:this.redirectUrl})}removeCleverLogin(t){return this.http.delete(this.cleverConfig.removeCleverLoginEndpoint+t)}getCleverId(){const t=localStorage.getItem("user");return void 0!==t&&null!=t?JSON.parse(t).cleverId:""}addCleverLog(t){return this.http.post(this.cleverConfig.addCleverLogEndpoint,t)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(F.O),e.LFG(Z.eN),e.LFG(O))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var k=i(6888),I=i(946),E=i(2468),J=i(5095),Y=i(3974);function q(o,s){if(1&o&&(e.TgZ(0,"div",17)(1,"h1"),e._uU(2),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.Oqu(t.maintenanceMessage)}}const D=function(){return["/auth/forgot-password"]};function Q(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",18)(1,"div",19),e.NdJ("click",function(){return e.CHM(t),e.oxw().loginWithClever()}),e._UZ(2,"img",20),e.qZA(),e.TgZ(3,"div",21)(4,"h3"),e._uU(5,"OR"),e.qZA()(),e.TgZ(6,"div",22)(7,"div",23)(8,"h5"),e._uU(9,"Login"),e.qZA()(),e.TgZ(10,"form")(11,"div",24)(12,"label",25),e._uU(13,"Username"),e.qZA(),e.TgZ(14,"div",26)(15,"input",27),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().credentials.UserName=n})("keydown.enter",function(){return e.CHM(t),e.oxw().loginUser()}),e.qZA(),e.TgZ(16,"div",28),e._uU(17),e.qZA()(),e.TgZ(18,"div",29)(19,"a",30),e.NdJ("click",function(){return e.CHM(t),e.oxw().openForgotUserNameModal()}),e._uU(20," Forgot Username?"),e.qZA()()(),e.TgZ(21,"div",24)(22,"label",31),e._uU(23,"Password"),e.qZA(),e.TgZ(24,"div",26)(25,"input",32),e.NdJ("ngModelChange",function(n){return e.CHM(t),e.oxw().credentials.Password=n})("keydown.enter",function(){return e.CHM(t),e.oxw().loginUser()}),e.qZA(),e.TgZ(26,"div",28),e._uU(27),e.qZA()(),e.TgZ(28,"div",29)(29,"a",33),e._uU(30,"Reset Password"),e.qZA()()(),e.TgZ(31,"div",24)(32,"div",34)(33,"button",35),e.NdJ("click",function(){return e.CHM(t),e.oxw().doLogin()}),e._uU(34," Sign in "),e.qZA(),e.TgZ(35,"button",35),e.NdJ("click",function(){return e.CHM(t),e.oxw().cancelChanges()}),e._uU(36," Cancel "),e.qZA()()(),e.TgZ(37,"span",36),e._uU(38),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(15),e.Q6J("ngModel",t.credentials.UserName),e.xp6(2),e.Oqu(t.userNameErrorMessage),e.xp6(8),e.Q6J("ngModel",t.credentials.Password),e.xp6(2),e.Oqu(t.passWordErrorMsg),e.xp6(2),e.Q6J("routerLink",e.DdM(6,D)),e.xp6(9),e.Oqu(t.errorMessage)}}i(8259);const B=[{path:"forgot-password",component:L},{path:"login",component:(()=>{class o{constructor(t,r,n,a,u,H,j,z,G){this._router=t,this.cleverService=r,this.userService=n,this.roleService=a,this._config=u,this._data=H,this._spinner=j,this.helperService=z,this.notifierService=G,this.ngUnsubscribe=new b.x,this.credentials=new S,this.userNameErrorMessage="",this.passWordErrorMsg="",this.errorMessage="",this.isLoggingIn=!1,this.isConfirmed=!1,this.emailAddress="",this.maintenanceMessage=g.N.maintenanceMessage,this.showMaintenanceMessage=g.N.showMaintenanceMessage,this.loginUser=()=>{this.doLogin()}}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}ngOnInit(){this._data.changeAuthStatus(!1),this.helperService.setPageTitleTranslated("login.login"),this.userService.clearLocalStorage("false")}doLogin(){this.clearValidation(),this.validateLogin()&&(this.isLoggingIn=!0,this._spinner.show(),this.userService.doLogin(this.credentials).subscribe({next:t=>{if(t){this.loginResponse=t,this.loginResponse.roles=this.roleService.createRoles(this.loginResponse.roles),this.userService.clearLocalStorage();const r=new T.B;this.userService.setCalendarViewStatus(r),this.userService.setUser(this.loginResponse),this.roleService.setRoles(this.loginResponse.roles),this._data.changeAuthStatus(!0),this._router.navigate(!0===this.loginResponse.resetPass||!0===this.loginResponse.updateAcct?["user/update"]:["/home"])}else this.errorMessage="There was a problem with your username or password. Please try again.";this._spinner.hide()},error:t=>{this.errorMessage="There was a problem with your username or password. Please try again.",this._spinner.hide()}}))}setWelcomeMessage(){this._data.changeWelcomeMessage(this._config.GetFirstAndLastName())}validateLogin(){let t=!0;return""===this.credentials.UserName.trim()&&(t=!1,this.userNameErrorMessage="User Name is required."),""===this.credentials.Password.trim()&&(t=!1,this.passWordErrorMsg="Password is required."),t}cancelChanges(){this.credentials.Password="",this.credentials.UserName="",this.clearValidation()}clearValidation(){this.userService.clearLocalStorage("false"),this.errorMessage="",this.userNameErrorMessage="",this.passWordErrorMsg=""}openForgotUserNameModal(){this.fpModalRef=(0,y.W)("#forgotUserName-modal"),this.fpModalRef.show()}closeForgotUserNameModal(){this.fpModalRef.hide()}sendEmail(){this.userService.sendUserNameResetLinkURL(this.emailAddress).pipe((0,p.R)(this.ngUnsubscribe)).subscribe(t=>{this.emailAddress="",t?(this.notifierService.showNotification("success","success","Username sent to your email address."),this.closeForgotUserNameModal()):(this.notifierService.showNotification("error","error","Unable to sent your username."),this.closeForgotUserNameModal())},t=>{this.emailAddress="",this.notifierService.showNotification("error","error","Unable to sent your username."),this.closeForgotUserNameModal()},()=>{this.emailAddress="",this.closeForgotUserNameModal()})}loginWithClever(){window.location.href=this.cleverService.getLIWCUrl()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d.F0),e.Y36(R),e.Y36(C.K),e.Y36(k.N),e.Y36(I.E),e.Y36(E.D),e.Y36(J.V),e.Y36(Y.W),e.Y36(x.l))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-login"]],decls:22,vars:3,consts:[["class","text-center mt-5",4,"ngIf"],["class","container",4,"ngIf"],["id","forgotUserName-modal","tabindex","-1","role","dialog","aria-labelledby","forgotUserName-modal",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],["id","formForgotUserName",1,"modal-body"],[1,"form-group"],["for","emailAddressForgotUserName col-md-3"],[1,"input-group","col-12"],["id","emailAddressForgotUserName","placeholder","email","name","emailAddressForgotUserName",1,"form-control",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button","id","extend-activitybtn",1,"btn","btn-danger",3,"click"],["type","button","id","btnCloseMapActivity","data-bs-dismiss","modal",1,"btn","btn-default"],[1,"text-center","mt-5"],[1,"container"],[1,"sso-container",3,"click"],["src","assets/images/clever-button.png",1,"clever-button"],[1,"text-center"],[1,"login-container"],[1,"login-header"],[1,"form-group","row"],["for","username",1,"col-sm-2","col-form-label"],[1,"col-sm-6"],["type","text","id","username","name","username","placeholder","Username",1,"form-control",3,"ngModel","ngModelChange","keydown.enter"],[1,"text-danger","text-start"],[1,"col-sm-4","login-link"],["href","javascript:void(0)",3,"click"],["for","password",1,"col-sm-2","col-form-label"],["type","password","id","password","name","password","placeholder","Password",1,"form-control",3,"ngModel","ngModelChange","keydown.enter"],["routerLinkActive","router-link-active",3,"routerLink"],[1,"col-sm-12","text-end"],["type","button",1,"btn","btn-primary","login-button",3,"click"],[1,"text-danger"]],template:function(t,r){1&t&&(e.YNc(0,q,3,1,"div",0),e.YNc(1,Q,39,7,"div",1),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h4",6),e._uU(7,"Forget Username?"),e.qZA(),e.TgZ(8,"button",7)(9,"span",8),e._uU(10,"\xd7"),e.qZA()()(),e.TgZ(11,"div",9)(12,"div",10)(13,"label",11),e._uU(14,"Provide the email associated with your account to receive your username"),e.qZA(),e.TgZ(15,"div",12)(16,"input",13),e.NdJ("ngModelChange",function(a){return r.emailAddress=a}),e.qZA()()()(),e.TgZ(17,"div",14)(18,"button",15),e.NdJ("click",function(){return r.sendEmail()}),e._uU(19,"Send"),e.qZA(),e.TgZ(20,"button",16),e._uU(21,"Close"),e.qZA()()()()()),2&t&&(e.Q6J("ngIf",r.showMaintenanceMessage),e.xp6(1),e.Q6J("ngIf",!r.showMaintenanceMessage),e.xp6(15),e.Q6J("ngModel",r.emailAddress))},directives:[_.O5,l._Y,l.JL,l.F,l.Fj,l.JJ,l.On,d.yS,d.Od],styles:["div.sso-container[_ngcontent-%COMP%]{background-color:#4274f6;border-radius:5px;cursor:pointer;display:block;margin:100px auto 20px;max-width:600px;text-align:center}div.login-container[_ngcontent-%COMP%]{border:1px solid #9b9b9b;border-radius:5px;box-shadow:5px 5px 10px #9b9b9b;box-sizing:border-box;margin:0 auto;max-width:600px;text-align:center}div.login-container[_ngcontent-%COMP%] > .login-header[_ngcontent-%COMP%]{padding:.5rem 1.25rem;margin-bottom:0;background-color:#00000008;border-bottom:1px solid rgba(0,0,0,.125)}div.login-container[_ngcontent-%COMP%] > form[_ngcontent-%COMP%]{padding:20px 10px 10px}div.login-container[_ngcontent-%COMP%] > form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-bottom:.5rem}.login-button[_ngcontent-%COMP%]{background-color:#3e9dd3;border-top:0;border-right:0;border-left:0;border-bottom:2px solid #2473a0;box-shadow:0 2px #0000001a}.login-button[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{background-color:#78bf57;border-bottom:2px solid #549238}.login-button[_ngcontent-%COMP%] + .login-button[_ngcontent-%COMP%]{margin-left:.25rem}"]}),o})()},{path:"",redirectTo:"login",pathMatch:"full"}];let W=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[d.Bz.forChild(B)],d.Bz]}),o})(),V=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[m.m,W]]}),o})()},8145:(M,c,i)=>{i.d(c,{W:()=>d});var m=i(7086);function d(v){const f=document.querySelector(v);return new m.u_(f,{keyboard:!1})}}}]);